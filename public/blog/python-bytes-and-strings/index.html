<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name=" robots" content="noindex, nofollow">
<title>Python&#39;s bytes and strings | Daniel Michaels | Software Developer</title>

<meta name="keywords" content="python" />
<meta name="description" content="Python: strings and bytes Python 3 is the new python, and python 2 should be regarded as legacy. But, it is still being used heavily and will likely live beyond its end of life. Recently, a project forced me to use python 2.7 within a Centos environment and I hit some small encoding issues.
Character Sequences In python there are two types that represent sequences of characters:
Python 3
 Bytes: raw 8 bit values Strings: unicode characters  Python 2">
<meta name="author" content="Daniel Michaels">
<link rel="canonical" href="https://danielms.site/blog/python-bytes-and-strings/" />
<link href="https://danielms.site/assets/css/stylesheet.min.08d6f2005b6ce4ed10207916c0411c66e66f2201e3f7a56e8fb2ccbc4a8b259c.css" integrity="sha256-CNbyAFts5O0QIHkWwEEcZuZvIgHj96Vuj7LMvEqLJZw=" rel="preload stylesheet"
    as="style">

<link rel="icon" href="https://danielms.site/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://danielms.site/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://danielms.site/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://danielms.site/apple-touch-icon.png">
<link rel="mask-icon" href="https://danielms.site/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.78.1" />




</head>

<body class="single" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>
<noscript>
    <style type="text/css">
        .theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://danielms.site/" accesskey="h">Daniel Michaels | Software Developer</a>
            <span class="logo-switches">
                <span class="theme-toggle">
                    <a id="theme-toggle" accesskey="t">
                        <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                            fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                        </svg>
                        <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                            fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round">
                            <circle cx="12" cy="12" r="5"></circle>
                            <line x1="12" y1="1" x2="12" y2="3"></line>
                            <line x1="12" y1="21" x2="12" y2="23"></line>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                            <line x1="1" y1="12" x2="3" y2="12"></line>
                            <line x1="21" y1="12" x2="23" y2="12"></line>
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                        </svg>
                    </a>
                </span>
                
            </span>
        </div>
        <ul class="menu" id="menu" onscroll="menu_on_scroll()">
            <li>
                <a href="https://danielms.site/blog/">
                    <span>
                        Blog
                    </span>
                </a>
            </li>
            <li>
                <a href="https://danielms.site/about/">
                    <span>
                        About
                    </span>
                </a>
            </li>
            <li>
                <a href="https://github.com/danielmichaels">
                    <span>
                        Code
                    </span>
                </a>
            </li></ul>
    </nav>
</header>

    <main class="main">

<article class="post-single">
  <header class="post-header">
    <h1 class="post-title">
      Python&#39;s bytes and strings
    </h1>
    <div class="post-meta">

October 23, 2018&nbsp;Â·&nbsp;Daniel Michaels

    </div>
  </header> 

  <div class="post-content">
<p><img src="https://danielms.site/images/unicode_logic.png" alt="test"></p>
<h1 id="python-strings-and-bytes">Python: strings and bytes<a hidden class="anchor" aria-hidden="true" href="#python-strings-and-bytes">#</a></h1>
<p>Python 3 is the new python, and python 2 should be regarded as legacy. But,
it is still being used heavily and will likely live beyond its end of life. Recently,
a project forced me to use python 2.7 within a Centos environment and I hit some
small encoding issues.</p>
<h2 id="character-sequences">Character Sequences<a hidden class="anchor" aria-hidden="true" href="#character-sequences">#</a></h2>
<p>In python there are two types that represent sequences of characters:</p>
<p><strong>Python 3</strong></p>
<ul>
<li>Bytes: raw 8 bit values</li>
<li>Strings: unicode characters</li>
</ul>
<p><strong>Python 2</strong></p>
<ul>
<li>Strings: raw 8 bit values</li>
<li>Unicode: unicode characters</li>
</ul>
<p>Python 3&rsquo;s strings and python 2&rsquo;s unicode instances do not have binary encoding.
Therefore, the user must implement the conversion manually by <code>encoding</code> and
<code>decoding</code> the between binary and unicode.</p>
<p>It is important that when constructing our program to deal with conversion between
these data types that it is done at the furthest boundaries of our interfaces.
This is sometimes referred to as the &lsquo;unicode sandwich&rsquo;.</p>
<p><img src="https://danielms.site/images/unicode_sandwhich.jpg" alt="unicode sandwich"></p>
<p>This guarantee&rsquo;s a level of compliance when accepting alternate encodings and
a much stricter output encoding scheme - generally <code>utf-8</code>. We should not be doing
any encoding or decoding in the middle of our applications.</p>
<p>This is of particular importance when dealing with file operations that are not
text. In python 3, file operations do much of the encoding and decoding for you,
returning <code>str</code> instances on read and write. But, python 3 will use the system
default encoding where an encoding scheme is not specified. Much of the time
we will receive <code>utf-8</code> but on some machines this is not guaranteed.</p>
<p>If your application is expected to work across multiple operating systems and/or
versions, you should set the <code>encoding=&lt;your-encoding type&gt;</code> keyword argument
manually to prevent hidden bugs in the future.</p>
<p>Subtle differences exist between python 2 and 3.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;encoding.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</code></pre></div><p>In python 2 this will work as by default <code>open</code> use binary encoding. However, python 3
uses <code>utf-8</code> instead. If we tried to run this it will raise a <code>TypeError: must be str not bytes</code>.</p>
<p>To make this work in both 2 and 3, we need to specify that it is binary.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;encoding.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</code></pre></div><p>Writing binary to a file must also be specified with <code>rb</code> instead of <code>r</code>.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;encoding.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
      <span class="k">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</code></pre></div><h3 id="notable-mentions">Notable mentions<a hidden class="anchor" aria-hidden="true" href="#notable-mentions">#</a></h3>
<p>Other interesting points between python 2&rsquo;s <code>str</code> and <code>unicode</code>, and python 3&rsquo;s
<code>str</code> and <code>bytes</code> are how they are compared, or typed. In python 2, if a
<code>str</code> is ASCII (7-bits) it will pass an equality check with <code>unicode</code> characters.
They can also be combined using the <code>+</code> operator, and can be formatted using
<code>%s</code> string formatting.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span>
<span class="n">b</span> <span class="o">=</span> <span class="sa">u</span><span class="s1">&#39;a&#39;</span>

<span class="n">a</span> <span class="o">==</span> <span class="n">b</span> <span class="c1"># true</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="c1"># u&#39;aa&#39;</span>
<span class="k">print</span> <span class="s1">&#39;as str a,b =</span><span class="si">%s%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="c1"># as str a,b=aa</span>
</code></pre></div><p>This means that in python 2 we could pass <code>unicode</code> or a <code>str</code> instance and expect
the same result - if 7-bit ASCII. In python 3 <code>str</code> and <code>bytes</code> never cannot
pass equality checks, not even empty strings.</p>
<h2 id="summary">Summary<a hidden class="anchor" aria-hidden="true" href="#summary">#</a></h2>
<p>Legacy python is still a thing, so having an understanding of how the encoding
paradigms differ between each version is important. The differences in file operations
can have significant effects within your applications, and is quite prominent in
network level communications. Wherever possible work with <code>str</code> types inside
your main business logic to alleviate any nasty surprises further down the line.</p>
<p>And have a read over some these gems regarding <code>utf-8</code>, which I deliberately
did not go over in any detail.</p>
<h3 id="references">references<a hidden class="anchor" aria-hidden="true" href="#references">#</a></h3>
<p>Ned Batchelder&rsquo;s <a href="https://nedbatchelder.com/text/unipain/unipain.html#1">How Do I Stop The Pain</a></p>
<p>Joel Spolsky&rsquo;s <a href="https://www.joelonsoftware.com/2003/10/08/the-absolute-minimum-every-software-developer-absolutely-positively-must-know-about-unicode-and-character-sets-no-excuses/">The Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses!)</a></p>

</div>
  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://danielms.site/tags/python">python</a></li>
    </ul>
  </footer>
</article>
    </main><footer class="footer">
    <span>&copy; 2020 <a href="https://danielms.site/">Daniel Michaels | Software Developer</a></span>
    <span>&middot;</span>
    <span>Powered by <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a></span>
    <span>&middot;</span>
    <span>Theme <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a></span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top" accesskey="g">
    <button class="top-link" id="top-link" type="button">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6">
            <path d="M12 6H0l6-6z" /></svg>
    </button>
</a>



<script defer src="https://danielms.site/assets/js/highlight.min.27cd435cc9ed6abb4b496581b151804f79f366c412620272bb94e2f5f598ebcc.js" integrity="sha256-J81DXMntartLSWWBsVGAT3nzZsQSYgJyu5Ti9fWY68w="
    onload="hljs.initHighlightingOnLoad();"></script>
<script>
    window.onload = function () {
        if (localStorage.getItem("menu-scroll-position")) {
            document.getElementById('menu').scrollLeft = localStorage.getItem("menu-scroll-position");
        }
    }
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                behavior: "smooth"
            });
        });
    });
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

    function menu_on_scroll() {
        localStorage.setItem("menu-scroll-position", document.getElementById('menu').scrollLeft);
    }

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>

</body>

</html>
