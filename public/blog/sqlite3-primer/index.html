<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name=" robots" content="noindex, nofollow">
<title>Sqlite3: A Primer | Daniel Michaels | Software Developer</title>

<meta name="keywords" content="SQL, eli5" />
<meta name="description" content="SQL Reference SQLite3 Specific Transactions SQLite transactions are ACID (Atomic, Consistent, Isolated and Durable). This means that data is not lost in the event of crashes, power failures or operating system dumps.
Atomic - Meaning changes cannot be broken down into smaller parts; either the entire transaction is commit or nothing at all.
Consistent - A transaction must ensure to change the database from one valid state to another. If a transaction results in invalid data, the database will revert its previous state.">
<meta name="author" content="Daniel Michaels">
<link rel="canonical" href="https://danielms.site/blog/sqlite3-primer/" />
<link href="https://danielms.site/assets/css/stylesheet.min.08d6f2005b6ce4ed10207916c0411c66e66f2201e3f7a56e8fb2ccbc4a8b259c.css" integrity="sha256-CNbyAFts5O0QIHkWwEEcZuZvIgHj96Vuj7LMvEqLJZw=" rel="preload stylesheet"
    as="style">

<link rel="icon" href="https://danielms.site/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://danielms.site/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://danielms.site/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://danielms.site/apple-touch-icon.png">
<link rel="mask-icon" href="https://danielms.site/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.78.1" />




</head>

<body class="single" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>
<noscript>
    <style type="text/css">
        .theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://danielms.site/" accesskey="h">Daniel Michaels | Software Developer</a>
            <span class="logo-switches">
                <span class="theme-toggle">
                    <a id="theme-toggle" accesskey="t">
                        <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                            fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                        </svg>
                        <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                            fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round">
                            <circle cx="12" cy="12" r="5"></circle>
                            <line x1="12" y1="1" x2="12" y2="3"></line>
                            <line x1="12" y1="21" x2="12" y2="23"></line>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                            <line x1="1" y1="12" x2="3" y2="12"></line>
                            <line x1="21" y1="12" x2="23" y2="12"></line>
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                        </svg>
                    </a>
                </span>
                
            </span>
        </div>
        <ul class="menu" id="menu" onscroll="menu_on_scroll()">
            <li>
                <a href="https://danielms.site/blog/">
                    <span>
                        Blog
                    </span>
                </a>
            </li>
            <li>
                <a href="https://danielms.site/about/">
                    <span>
                        About
                    </span>
                </a>
            </li>
            <li>
                <a href="https://github.com/danielmichaels">
                    <span>
                        Code
                    </span>
                </a>
            </li></ul>
    </nav>
</header>

    <main class="main">

<article class="post-single">
  <header class="post-header">
    <h1 class="post-title">
      Sqlite3: A Primer
    </h1>
    <div class="post-meta">

September 9, 2018&nbsp;Â·&nbsp;Daniel Michaels

    </div>
  </header> 

  <div class="post-content">
<h1 id="sql-reference">SQL Reference<a hidden class="anchor" aria-hidden="true" href="#sql-reference">#</a></h1>
<h2 id="sqlite3-specific">SQLite3 Specific<a hidden class="anchor" aria-hidden="true" href="#sqlite3-specific">#</a></h2>
<h3 id="transactions">Transactions<a hidden class="anchor" aria-hidden="true" href="#transactions">#</a></h3>
<p>SQLite transactions are ACID (Atomic, Consistent, Isolated and Durable). This means that data is not lost in the event of crashes, power failures or operating system dumps.</p>
<p><strong>Atomic</strong>
- Meaning changes cannot be broken down into smaller parts; either the entire transaction is commit or nothing at all.</p>
<p><strong>Consistent</strong>
- A transaction must ensure to change the database from one valid state to another. If a transaction results in invalid data, the database will revert its previous state.</p>
<p><strong>Isolated</strong>
- Transactions are isolated from one client to the next. When changes are made to the database the changes are only visible to that client until it is committed. If two people concurrently make changes to a database, they will be transacted sequentially. It does not ensure the order of transactions.</p>
<p><strong>Durability</strong>
- If a transaction is successfully committed, the changes are permanent going forward, if it is interrupted during the commit it will revert to its previous state.</p>
<p><img src="https://danielms.site/images/acid.svg" alt="Julia Evans ACID drawing" title="ACID in cartoon format"></p>
<p><strong>Please check out Julia Evans work at <a href="https://jvns.ca">https://jvns.ca</a></strong></p>
<p>SQLite3 uses auto-commit mode by default.</p>
<h3 id="select">Select<a hidden class="anchor" aria-hidden="true" href="#select">#</a></h3>
<p>Used to query data from one or more tables. Example below:</p>
<div class="highlight"><pre class="chroma"><code class="language-SQL" data-lang="SQL"><span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="n">column_list</span>
<span class="k">FROM</span> <span class="n">table_list</span>
  <span class="k">JOIN</span> <span class="k">table</span> <span class="k">ON</span> <span class="n">join_condition</span>
<span class="k">WHERE</span> <span class="n">row_filter</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="k">column</span>
<span class="k">LIMIT</span> <span class="k">count</span> <span class="k">OFFSET</span> <span class="k">offset</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="k">column</span>
<span class="k">HAVING</span> <span class="n">group_filter</span><span class="p">;</span>
</code></pre></div><p>A breakdown of each clause:</p>
<ul>
<li>
<p><code>ORDER BY</code> sorts the result set,</p>
</li>
<li>
<p><code>DISTINCT</code> gets unique rows in a table,</p>
</li>
<li>
<p><code>WHERE</code> is a filter such as, <code>WHERE employees IS NULL</code>,</p>
</li>
<li>
<p><code>LIMIT   OFFSET</code> will return a set number of rows,</p>
</li>
<li>
<p><code>GROUP BY</code> sorts columns into groups and applies functions to each group,</p>
</li>
<li>
<p><code>HAVING</code> is another filter that checks for presence of the operator.</p>
</li>
</ul>
<p><code>SELECT * FROM database_table</code> is acceptable usage in testing or development but in production the query should be explicit.</p>
<h3 id="insert">Insert<a hidden class="anchor" aria-hidden="true" href="#insert">#</a></h3>
<p>Used to insert new data be it single row, multiple rows, and default data into tables.</p>
<div class="highlight"><pre class="chroma"><code class="language-SQL" data-lang="SQL"><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">table1</span> <span class="p">(</span>
 <span class="n">column1</span><span class="p">,</span>
 <span class="n">column2</span> <span class="p">,..)</span>
<span class="k">VALUES</span>
 <span class="p">(</span>
 <span class="n">value1</span><span class="p">,</span>
 <span class="n">value2</span> <span class="p">,...),</span>
 <span class="p">(</span>
 <span class="n">value1</span><span class="p">,</span>
 <span class="n">value2</span> <span class="p">,...),</span>
        <span class="p">...</span>
 <span class="p">(</span>
 <span class="n">value1</span><span class="p">,</span>
 <span class="n">value2</span> <span class="p">,...);</span>
</code></pre></div><p>The above example shows how to insert multiple rows into a table.</p>
<div class="highlight"><pre class="chroma"><code class="language-SQL" data-lang="SQL"><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">artists</span> <span class="p">(</span><span class="n">name</span><span class="p">)</span>
<span class="k">VALUES</span>
 <span class="p">(</span><span class="s2">&#34;Buddy Rich&#34;</span><span class="p">),</span>
 <span class="p">(</span><span class="s2">&#34;Candido&#34;</span><span class="p">),</span>
 <span class="p">(</span><span class="s2">&#34;Charlie Byrd&#34;</span><span class="p">);</span>
</code></pre></div><p>An example of how to insert into column <code>name</code> within table <code>artists</code>.</p>
<p>Data can also be inserted via a SELECT statement.</p>
<h3 id="update">Update<a hidden class="anchor" aria-hidden="true" href="#update">#</a></h3>
<p>Update already existing data in a table.</p>
<div class="highlight"><pre class="chroma"><code class="language-SQL" data-lang="SQL"><span class="k">UPDATE</span> <span class="k">table</span>
<span class="k">SET</span> <span class="n">column_1</span> <span class="o">=</span> <span class="n">new_value_1</span><span class="p">,</span>
    <span class="n">column_2</span> <span class="o">=</span> <span class="n">new_value_2</span>
<span class="k">WHERE</span>
    <span class="n">search_condition</span> 
<span class="k">ORDER</span> <span class="n">column_or_expression</span>
<span class="k">LIMIT</span> <span class="k">row_count</span> <span class="k">OFFSET</span> <span class="k">offset</span><span class="p">;</span>
</code></pre></div><p>the <code>UPDATE</code> clause informs SQL that some part of the table is going to be amended. the <code>SET</code> clause signifies and allows the updating of the column/s that precede it. On the left of the assignment operator (=) is the column to be updated and on the right the new value, expression or data. Whilst the <code>WHERE</code> operator is optional if it is omitted all rows will be updated.</p>
<h3 id="delete">Delete<a hidden class="anchor" aria-hidden="true" href="#delete">#</a></h3>
<p>The delete statement allows for deletion of one, multiple or all rows within a table.</p>
<div class="highlight"><pre class="chroma"><code class="language-SQL" data-lang="SQL"><span class="k">DELETE</span>
<span class="k">FROM</span>
 <span class="k">table</span>
<span class="k">WHERE</span>
 <span class="n">search_condition</span><span class="p">;</span>
</code></pre></div><p>Like updating a table, <code>WHERE</code>, <code>ORDER BY</code> and <code>LIMIT</code> clauses can be applied to a delete operation. In addition deletes can be orchestrated through the <code>SELECT</code> operator.</p>
<h2 id="joins">JOINS<a hidden class="anchor" aria-hidden="true" href="#joins">#</a></h2>
<h3 id="inner-joins">Inner Joins<a hidden class="anchor" aria-hidden="true" href="#inner-joins">#</a></h3>
<p>In relation databases, data is often distributed amongst many related tables. Foreign Keys are used to associate these tables.</p>
<p><code>INNER JOIN</code> clause will combine columns from correlated tables.</p>
<p>In fig 1.1 Table A&rsquo;s &lsquo;f&rsquo; column is compared with table B&rsquo;s &lsquo;f&rsquo; column. If the value of the &lsquo;f&rsquo; column in the A table equals that of B&rsquo;s &lsquo;f&rsquo; column it will return the match. More simply, <code>INNER JOIN</code> clauses return rows from table A that have corresponding rows in the B table.</p>
<p><img src="https://danielms.site/images/SQLite-Inner-Join-Example.png" alt="Inner Join" title="example of inner join"></p>
<p>Fig 1.1 Inner Join</p>
<p><code>INNER JOIN</code> may connect more than two tables. This will require two inner join clauses form the <code>SELECT</code> statement.</p>
<div class="highlight"><pre class="chroma"><code class="language-SQL" data-lang="SQL"><span class="k">SELECT</span>
 <span class="n">trackid</span><span class="p">,</span>
 <span class="n">tracks</span><span class="p">.</span><span class="n">name</span> <span class="k">AS</span> <span class="n">Track</span><span class="p">,</span>
 <span class="n">albums</span><span class="p">.</span><span class="n">title</span> <span class="k">AS</span> <span class="n">Album</span><span class="p">,</span>
 <span class="n">artists</span><span class="p">.</span><span class="n">name</span> <span class="k">AS</span> <span class="n">Artist</span>
<span class="k">FROM</span>
 <span class="n">tracks</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">albums</span> <span class="k">ON</span> <span class="n">albums</span><span class="p">.</span><span class="n">albumid</span> <span class="o">=</span> <span class="n">tracks</span><span class="p">.</span><span class="n">albumid</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">artists</span> <span class="k">ON</span> <span class="n">artists</span><span class="p">.</span><span class="n">artistid</span> <span class="o">=</span> <span class="n">albums</span><span class="p">.</span><span class="n">artistid</span><span class="p">;</span>
</code></pre></div><p>Example code of a query joining three tables by their Artist. (from Chinook.db found at SQLite&rsquo;s website tutorial.)</p>
<p><img src="https://danielms.site/images/SQLite-Inner-Join-3-tables.jpg" alt="Inner Join Example" title="result set of inner join on three tables."></p>
<p>Fig. 1.2 is the result set of the above query.</p>
<h3 id="full-outer-join">Full Outer Join<a hidden class="anchor" aria-hidden="true" href="#full-outer-join">#</a></h3>
<p><strong>this command is not in SQLite3</strong></p>
<p>Theoretically, the result of a Right Join and Left Join with <code>NULL</code> values for every column of the table that does not have a matching row.</p>
<p>This is technically not available in SQLite3, however they do offer a workaround.</p>
<p>Given that SQLite3 does not have <code>RIGHT JOIN</code> or <code>FULL OUTER JOIN</code> it uses both <code>UNION</code> and <code>LEFT JOIN</code> to emulate it.</p>
<p>It achieves this by switching the position of the <code>LEFT JOIN</code> clause over both columns. SQLite also uses <code>UNION ALL</code> to duplicate rows from the result set of both queries. Finally, the use of a <code>WHERE</code> clause will remove rows already included in the result set of the first <code>SELECT</code> statement. See the below code for an example.</p>
<div class="highlight"><pre class="chroma"><code class="language-SQL" data-lang="SQL">
<span class="k">SELECT</span> <span class="n">d</span><span class="p">.</span><span class="k">type</span><span class="p">,</span>
         <span class="n">d</span><span class="p">.</span><span class="n">color</span><span class="p">,</span>
         <span class="k">c</span><span class="p">.</span><span class="k">type</span><span class="p">,</span>
         <span class="k">c</span><span class="p">.</span><span class="n">color</span>
<span class="k">FROM</span> <span class="n">dogs</span> <span class="n">d</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">cats</span> <span class="k">c</span> <span class="k">USING</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
<span class="k">UNION</span> <span class="k">ALL</span>
<span class="k">SELECT</span> <span class="n">d</span><span class="p">.</span><span class="k">type</span><span class="p">,</span>
         <span class="n">d</span><span class="p">.</span><span class="n">color</span><span class="p">,</span>
         <span class="k">c</span><span class="p">.</span><span class="k">type</span><span class="p">,</span>
         <span class="k">c</span><span class="p">.</span><span class="n">color</span>
<span class="k">FROM</span> <span class="n">cats</span> <span class="k">c</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">dogs</span> <span class="n">d</span> <span class="k">USING</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
<span class="k">WHERE</span> <span class="n">d</span><span class="p">.</span><span class="n">color</span> <span class="k">IS</span> <span class="k">NULL</span><span class="p">;</span>
</code></pre></div><h2 id="terms-definitions">Terms/ Definitions<a hidden class="anchor" aria-hidden="true" href="#terms-definitions">#</a></h2>
<h3 id="primary-key">Primary Key<a hidden class="anchor" aria-hidden="true" href="#primary-key">#</a></h3>
<p>In order to qualify as a relational table, it must have a primary key.</p>
<p>The <strong>primary key</strong> consists of one or more columns whose data contained within is used to uniquely identify each row in the table.
<em>metaphor</em> If rows were mailboxes the primary key would be the street address.</p>
<p>To be a true primary key it must be:</p>
<ul>
<li>Unique (data, not the name),</li>
<li>Must not be NULL or &quot;&quot;</li>
</ul>
<p>Tables must have primary keys, and these are stored in an index which is used to enforce the uniqueness requirement. Being indexed, accessing it does not necessitate scanning the entire table.</p>
<h3 id="foreign-key">Foreign Key<a hidden class="anchor" aria-hidden="true" href="#foreign-key">#</a></h3>
<p>A <strong>foreign key</strong> is one or more columns in a table that refers to the primary key or unique identifier in another table.</p>
<p>They unlike primary keys <strong>can contain NULL, blank or duplicate values</strong>. As they allow duplication it is best not to use a foreign key as a primary key, unless it is a one-to-one relationship.</p>
<p><img src="https://danielms.site/images/foreign_key.png" alt="input" title="example foreign key"></p>
<p>In the above picture we have a Students and Cities table. PERSON_ID and CITY_ID are unique, and therefore make good Primary keys (which they are). Inside the Students table it is possible for several students to be born in the same city. As such the BIRTH_PLACE column is the foreign key to the Cities table. This ensures that there is relationship between the tables and that relation points to something unique in the other table.</p>
<h3 id="unions">Union&rsquo;s<a hidden class="anchor" aria-hidden="true" href="#unions">#</a></h3>
<p><em>BLUF: combines result set of two or more queries into a single result set.</em></p>
<p><code>UNION</code> by default removes duplicate rows whereas <code>UNION ALL</code> does not. As <code>UNION ALL</code> does not remove duplicates it will process faster. Both statements have the following rules:</p>
<ul>
<li>Must have the same number of columns,</li>
<li>Corresponding columns must be same data type,</li>
<li>The column names of the first query will determine the column of the combined result set,</li>
<li>Any <code>GROUP BY</code> and <code>HAVING</code> clauses are applied to each individual query, not the final result set,</li>
<li>The <code>ORDER BY</code> is applied to the combined result set, not the individual result sets.</li>
</ul>
<h3 id="transaction">Transaction<a hidden class="anchor" aria-hidden="true" href="#transaction">#</a></h3>
<p>The basis of all interactions with the database. Inserts, updates, deletes, commits and table creation and deletion are all transactions.</p>

</div>
  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://danielms.site/tags/sql">SQL</a></li>
      <li><a href="https://danielms.site/tags/eli5">eli5</a></li>
    </ul>
  </footer>
</article>
    </main><footer class="footer">
    <span>&copy; 2020 <a href="https://danielms.site/">Daniel Michaels | Software Developer</a></span>
    <span>&middot;</span>
    <span>Powered by <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a></span>
    <span>&middot;</span>
    <span>Theme <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a></span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top" accesskey="g">
    <button class="top-link" id="top-link" type="button">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6">
            <path d="M12 6H0l6-6z" /></svg>
    </button>
</a>



<script defer src="https://danielms.site/assets/js/highlight.min.27cd435cc9ed6abb4b496581b151804f79f366c412620272bb94e2f5f598ebcc.js" integrity="sha256-J81DXMntartLSWWBsVGAT3nzZsQSYgJyu5Ti9fWY68w="
    onload="hljs.initHighlightingOnLoad();"></script>
<script>
    window.onload = function () {
        if (localStorage.getItem("menu-scroll-position")) {
            document.getElementById('menu').scrollLeft = localStorage.getItem("menu-scroll-position");
        }
    }
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                behavior: "smooth"
            });
        });
    });
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

    function menu_on_scroll() {
        localStorage.setItem("menu-scroll-position", document.getElementById('menu').scrollLeft);
    }

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>

</body>

</html>
